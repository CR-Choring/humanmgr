(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-55b91167"],{"0e8f":function(e,t,r){"use strict";r("99af");var a=r("b775");t["a"]={getDepartmentListPage:function(e,t){return Object(a["a"])({url:"/staff/department/listPage/".concat(e,"/").concat(t),method:"get"})},deleteDepartmentById:function(e){return Object(a["a"])({url:"/staff/department/".concat(e),method:"delete"})},addDepartment:function(e){return Object(a["a"])({url:"/staff/department",method:"post",data:e})},getDepartmentById:function(e){return Object(a["a"])({url:"/staff/department/".concat(e),method:"get"})},updateDepartment:function(e){return Object(a["a"])({url:"/staff/department",method:"put",data:e})},getDepartmentList:function(){return Object(a["a"])({url:"/staff/department/list",method:"get"})}}},"883c":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-form",{ref:"clerk",attrs:{model:e.clerk,rules:e.rule,"label-width":"120px"}},[r("el-form-item",{attrs:{label:"员工编号"}},[r("el-col",{attrs:{span:6}},[r("el-input",{attrs:{span:6,disabled:!0},model:{value:e.clerk.id,callback:function(t){e.$set(e.clerk,"id",t)},expression:"clerk.id"}})],1)],1),r("el-form-item",{attrs:{prop:"name",label:"员工名称"}},[r("el-col",{attrs:{span:4}},[r("el-input",{attrs:{maxlength:"5","show-word-limit":""},model:{value:e.clerk.name,callback:function(t){e.$set(e.clerk,"name",t)},expression:"clerk.name"}})],1)],1),r("el-form-item",{attrs:{prop:"sex",label:"性别"}},[r("el-col",{attrs:{span:4}},[r("el-radio",{attrs:{prop:"sex",label:"0"},model:{value:e.clerk.sex,callback:function(t){e.$set(e.clerk,"sex",t)},expression:"clerk.sex"}},[e._v("女")]),r("el-radio",{attrs:{prop:"sex",label:"1"},model:{value:e.clerk.sex,callback:function(t){e.$set(e.clerk,"sex",t)},expression:"clerk.sex"}},[e._v("男")])],1)],1),r("el-form-item",{attrs:{prop:"phoneNumber",label:"手机号"}},[r("el-col",{attrs:{span:6}},[r("el-input",{model:{value:e.clerk.phoneNumber,callback:function(t){e.$set(e.clerk,"phoneNumber",t)},expression:"clerk.phoneNumber"}})],1)],1),r("el-form-item",{attrs:{prop:"idCard",label:"身份证号"}},[r("el-col",{attrs:{span:8}},[r("el-input",{model:{value:e.clerk.idCard,callback:function(t){e.$set(e.clerk,"idCard",t)},expression:"clerk.idCard"}})],1)],1),r("el-form-item",{attrs:{prop:"address",label:"地址"}},[r("el-input",{model:{value:e.clerk.address,callback:function(t){e.$set(e.clerk,"address",t)},expression:"clerk.address"}})],1),r("el-form-item",{attrs:{prop:"position",label:"职务"}},[r("el-col",{attrs:{span:4}},[r("el-input",{model:{value:e.clerk.position,callback:function(t){e.$set(e.clerk,"position",t)},expression:"clerk.position"}})],1)],1),r("el-form-item",{attrs:{prop:"departmentId",label:"部门"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.clerk.departmentId,callback:function(t){e.$set(e.clerk,"departmentId",t)},expression:"clerk.departmentId"}},e._l(e.departmentList,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),r("el-form-item",{attrs:{prop:"password",label:"密码"}},[r("el-col",{attrs:{span:6}},[r("el-input",{attrs:{type:"password",autocomplete:"new-password",placeholder:"不填写则不修改（新建时必填）"},model:{value:e.clerk.password,callback:function(t){e.$set(e.clerk,"password",t)},expression:"clerk.password"}})],1)],1),r("el-form-item",{attrs:{prop:"confirmPassword",label:"确认密码"}},[r("el-col",{attrs:{span:6}},[r("el-input",{attrs:{type:"password",autocomplete:"new-password",placeholder:"请再次输入密码"},model:{value:e.clerk.confirmPassword,callback:function(t){e.$set(e.clerk,"confirmPassword",t)},expression:"clerk.confirmPassword"}})],1)],1),r("el-form-item",{attrs:{label:"员工照片"}},[r("pan-thumb",{attrs:{image:e.clerk.photo}}),r("el-button",{staticStyle:{"font-size":"16px"},attrs:{type:"primary"},on:{click:function(t){e.imagecropperShow=!0}}},[e._v(" 更换照片")]),r("image-cropper",{directives:[{name:"show",rawName:"v-show",value:e.imagecropperShow,expression:"imagecropperShow"}],key:e.imagecropperKey,attrs:{width:300,height:300,url:"http://localhost:9181/oss/fileoss/uploadOssFile",field:"file"},on:{close:e.close,"crop-upload-success":e.cropSuccess}})],1),r("el-form-item",[r("el-button",{staticStyle:{"font-size":"16px"},attrs:{disabled:e.saveBtnDisabled,type:"primary"},on:{click:function(t){return e.saveOrUpdate("clerk")}}},[e._v(" 保存")]),r("el-button",{staticStyle:{"font-size":"16px"},on:{click:function(t){return e.resetForm("clerk")}}},[e._v(" 重置")])],1)],1)],1)},s=[],n=r("ade3"),l=(r("ac1f"),r("00b4"),r("4d90"),r("e9c4"),r("9ffe")),o=r("0e8f"),i=r("896b"),c=r("3cbc"),u={components:{ImageCropper:i["a"],PanThumb:c["a"]},data:function(){var e,t=function(e,t,r){if(!t)return r(new Error("手机号不能为空"));var a=/^1[3|4|5|7|8][0-9]\d{8}$/;if(!a.test(t))return r(new Error("请输入正确的手机号"));r()};return e={baseApi:"https://api-administration.choringedu.cn",clerk:{},saveBtnDisabled:!1,departmentList:null},Object(n["a"])(e,"saveBtnDisabled",!1),Object(n["a"])(e,"imagecropperShow",!1),Object(n["a"])(e,"imagecropperKey",0),Object(n["a"])(e,"rule",{sex:[{required:!0,message:"请选择性别",trigger:"change"}],address:[{required:!0,message:"请填写地址",trigger:"change"}],position:[{required:!0,message:"请填写职务",trigger:"change"}],departmentId:[{required:!0,message:"请选择部门",trigger:"change"}],phoneNumber:[{validator:t,required:!0,trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"},{min:2,max:10,message:"长度在 2 到 10 个字符",trigger:"blur"},{required:!0,pattern:/^[\u4e00-\u9fa5_a-zA-Z0-9.·-]+$/,message:"姓名不支持特殊字符",trigger:"blur"}],idCard:[{required:!0,message:"请输入身份证号",trigger:"blur"},{min:15,max:18,message:"请如实填写18位号码，以供核对",trigger:"blur"},{required:!0,pattern:/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/,message:"请输入正确的身份证号码",trigger:"blur"}]}),e},created:function(){this.init(),this.initDepartment()},watch:{$route:function(e,t){this.init()},"clerk.departmentId":function(){this.generateClerkId()}},methods:{resetForm:function(e){this.$refs[e].resetFields()},close:function(){this.imagecropperShow=!1,this.imagecropperKey=this.imagecropperKey+1},cropSuccess:function(e){this.imagecropperShow=!1,this.clerk.photo=e.url,this.imagecropperKey=this.imagecropperKey+1},init:function(){if(this.$route.params&&this.$route.params.id){var e=this.$route.params.id;this.getClerkById(e)}else this.clerk={}},initDepartment:function(){var e=this;o["a"].getDepartmentList().then((function(t){e.departmentList=t.data.departmentList}))},updateClerk:function(){var e=this,t=Object.assign({},this.clerk);delete t.confirmPassword,t.password||delete t.password,l["a"].updateClerk(t).then((function(t){e.$message({type:"success",message:"修改成功!"}),e.$router.push({path:"/clerk/listClerk"})})).catch((function(t){e.$message({type:"error",message:e.getErrorMsg(t)})}))},getClerkById:function(e){var t=this;l["a"].getClerkById(e).then((function(e){t.clerk=e.data.clerk,t.clerk||(t.clerk={}),t.clerk.photo||(t.clerk.photo="file/default.svg"),t.clerk.password="",t.clerk.confirmPassword=""})).catch((function(e){t.$message({type:"error",message:t.getErrorMsg(e)})}))},saveOrUpdate:function(e){var t=this;this.$refs[e].validate((function(e){e&&(t.$route.params&&t.$route.params.id?t.updateClerk():t.saveClerk())}))},generateClerkId:function(){if(this.clerk.departmentId){var e=new Date,t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),a=this.clerk.departmentId,s="001";this.clerk.id=t+r+a+s}else this.clerk.id=""},saveClerk:function(e){var t=this;if(this.clerk.password)if(this.clerk.password===this.clerk.confirmPassword){this.clerk.photo||(this.clerk.photo="file/default.svg");var r=Object.assign({},this.clerk);delete r.confirmPassword,l["a"].addClerk(r).then((function(e){t.$message({type:"success",message:"添加成功"}),t.$router.push({path:"/permissions/listClerk"})})).catch((function(e){t.$message({type:"error",message:t.getErrorMsg(e)})}))}else this.$message({type:"warning",message:"两次输入的密码不一致"});else this.$message({type:"warning",message:"请填写密码"})},getErrorMsg:function(e){try{if(!e)return"未知错误";if(e.response&&e.response.data){var t=e.response.data;return t.message?t.message:JSON.stringify(t)}return e.message?e.message:String(e)}catch(r){return"未知错误"}}}},d=u,p=r("2877"),m=Object(p["a"])(d,a,s,!1,null,null,null);t["default"]=m.exports},"9ffe":function(e,t,r){"use strict";r("99af");var a=r("b775");t["a"]={getClerkListPage:function(e,t,r){return Object(a["a"])({url:"/staff/clerk/listPage/".concat(e,"/").concat(t),method:"post",data:r})},getClerkListPageLizhi:function(e,t,r){return Object(a["a"])({url:"/staff/clerk/listPageLiZhi/".concat(e,"/").concat(t),method:"post",data:r})},deleteClerkById:function(e){return Object(a["a"])({url:"/staff/clerk/".concat(e),method:"delete"})},addClerk:function(e){return Object(a["a"])({url:"/staff/clerk",method:"post",data:e})},getClerkById:function(e){return Object(a["a"])({url:"/staff/clerk/".concat(e),method:"get"})},updateClerk:function(e){return Object(a["a"])({url:"/staff/clerk",method:"put",data:e})},getClerkList:function(){return Object(a["a"])({url:"/staff/clerk/list",method:"get"})},getClerkAndUserRole:function(){return Object(a["a"])({url:"/staff/clerk/getClerkAndUserRole",method:"post"})},updateUser:function(e){return Object(a["a"])({url:"/staff/user",method:"put",data:e})},getPassword:function(e){return Object(a["a"])({url:"/staff/user/getPassword/"+e,method:"post"})},putPassword:function(e){return Object(a["a"])({url:"/staff/user/putPassword/"+e,method:"put"})},getClerkByDepartmentId:function(e){return Object(a["a"])({url:"/staff/clerk/getClerkByDepartmentId/"+e,method:"get"})},resetPassword:function(e){return Object(a["a"])({url:"/staff/user/resetPassword/"+e,method:"put"})}}},e9c4:function(e,t,r){var a=r("23e7"),s=r("d066"),n=r("d039"),l=s("JSON","stringify"),o=/[\uD800-\uDFFF]/g,i=/^[\uD800-\uDBFF]$/,c=/^[\uDC00-\uDFFF]$/,u=function(e,t,r){var a=r.charAt(t-1),s=r.charAt(t+1);return i.test(e)&&!c.test(s)||c.test(e)&&!i.test(a)?"\\u"+e.charCodeAt(0).toString(16):e},d=n((function(){return'"\\udf06\\ud834"'!==l("\udf06\ud834")||'"\\udead"'!==l("\udead")}));l&&a({target:"JSON",stat:!0,forced:d},{stringify:function(e,t,r){var a=l.apply(null,arguments);return"string"==typeof a?a.replace(o,u):a}})}}]);